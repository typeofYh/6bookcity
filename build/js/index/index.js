"use strict";define(["jquery","temp","swiper","lazyload","text!template/index.html","text!template/bolck-list.html","text!template/recommend-list.html","text!template/dl-list.html"],function(n,s,t,a,e,i,c,l){var o=0;function d(t,a){var e=5*t,i=5*t+5,o=a.slice(e,i);return o.map(function(t,a){t.count=a+1}),o}n(".header span").on("click",function(){o=n(this).index(),n(".header span").eq(o).addClass("active").siblings().removeClass("active"),n(".content").css({transform:"translate(-"+100*o+"%,0)"})}),n.ajax({url:"/api/index",dataType:"json",success:function(o){s(e,o.items[0].data,".book-city-cont"),new t(".banner",{loop:!0,autoplay:{delay:1e3}}),s(i,o.items[1].data.data,".week-hot-cont"),o.items[5].data.data.map(function(t){t.title=t.data.title,t.cover=t.data.cover,t.fiction_id=t.data.fiction_id}),s(i,o.items[5].data.data,".time-free-cont");s(c,d(0,o.items[2].data.data),".recommend-cont"),s(l,d(0,o.items[3].data.data),".gril-cont"),s(l,d(0,o.items[4].data.data),".boy-cont"),s(n(".text").html(),o.items[6],".sift-cont"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-city")}),f(".book-city"),n(".book-city").on("click",".change-btn",function(){var t=1*n(this).data("id"),a=n(this).attr("data"),e=o.items[a];t++,t%=e.data.count/5,n(this).data("id",t);var i=2==a?c:l;s(i,d(t,e.data.data),"."+n(this).prev().attr("class"))})}}),n.ajax({url:"/api/bookself",dataType:"json",success:function(t){s(i,t.items,".book-self-cont>div"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-self")}),n(".book-self-btn").on("click",function(){n(this).toggleClass("active"),n(this).hasClass("active")?s(i,t.items,".book-self-cont>div"):s(l,t.items,".book-self-cont>div"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-self")})})}});var r=0;function f(t){if(3<=r)return n(".loading").html("暂无更多数据"),!1;var e=n(t).height();n(t).on("scroll",function(){var t,a=n(this).children().height()-e;n(this).scrollTop()+40>=a&&(n(this).off("scroll"),t=++r,n.ajax({url:"/api/loadmore",data:{pagenum:t,limit:20},dataType:"json",success:function(t){s(l,t.items,".load-cont-list",1),f(".book-city"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-city")})}}))})}});